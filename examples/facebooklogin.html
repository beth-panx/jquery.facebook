<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width" />
		<meta name="keywords" content="jquery, plugin, facebook" />
		<meta name="description" content="A jQuery plugin to easy use the facebook js" />
		<title>jQuery Facebook :: Examples :: Facebook Login</title>
		<script type="text/javascript" src="http://code.jquery.com/jquery-2.0.2.min.js"></script>
		<script type="text/javascript" src="../js/jquery.facebook.js"></script>
		<link rel="stylesheet" href="../css/auth-buttons.css">
		<link rel="stylesheet" href="facebooklogin.css">
	</head>
	<body>
		<div id="facebooklogin" class="alpha90 round">
			<h2 class="formh2">Login / Register</h2>
			<input id="terms" type="checkbox" name="terms" value="1" style="margin-top:20px;">
			I agree to the <a href="https://github.com/grizzly/jquery.facebook" target="_blank">Terms and Conditions</a>!
			<br>
			<div id="fbbutton">

			</div>
		</div>
		<div id="facebooklogin" class="alpha90 round" style="margin-top:20px;">
			<center>
				<a href="https://github.com/grizzly/jquery.facebook">Get the source code from GitHub!</a>
			</center>
		</div>
		<script type="text/javascript">
			$("#fbbutton").html('<div class="btn-auth btn-facebook large transparent">Connecting to <b>Facebook</b></div>');

			var facebook = $.facebook({
				appid : 483460708442988,
				locale : "en_EN",
				scope : "email, user_birthday, user_interests, user_location, publish_actions"
			});

			facebook.onLoginConnected = function(response) {
				$("#fbbutton").html('<a class="btn-auth btn-facebook large" href="javascript:;" onclick="doLogin()">Login with <b>Facebook</b></a>');
			};

			facebook.onLoginNotAuthorized = facebook.onLoginNotLoggedIn = function() {
				$("#fbbutton").html('<a class="btn-auth btn-facebook large" href="javascript:;" onclick="doLogin();">Login with <b>Facebook</b></a>');
			};

			facebook.onLoginCancelled = function() {
				top.location = "https://example.com/";
			};

			facebook.onLoginNotAuthorized = function() {
				$("#fbbutton").html('<a class="btn-auth btn-facebook large" href="javascript:;" onclick="doLogin();">Login with <b>Facebook</b></a>');
			};

			facebook.onLoginNotLoggedIn = function() {
				$("#fbbutton").html('<a class="btn-auth btn-facebook large" href="javascript:;" onclick="doLogin();">Login with <b>Facebook</b></a>');
			};

			facebook.onLoginSuccess = function(response) {
				$("#fbbutton").html('<div class="btn-auth btn-facebook large transparent">Loading App ...</b></div>');
				// register access token at your's servers backend
				$.ajax({
					type : "POST",
					url : "//example.com/login.php?access_token=" + response.authResponse.accessToken,
					dataType : "jsonp",
					success : function(data) {
						if (data.loggedin == true) {
							// redirect to your member area
							window.location = "http://grizzly.cc";
						}
					},
					error : function(data) {
						// in case the login server could not be reached
						window.location = "http://grizzly.cc";
					}
				});
			};

			function doLogin() {
				if ($('#terms').is(":checked")) {
					facebook.login();
				} else {
					alert("You have to accept the terms and conditions first!")
				}
			}

		</script>
	</body>
</html>